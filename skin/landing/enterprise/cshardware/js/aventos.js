var hs_table = [
[349, [[23.1, ""], [20.77, "B.20S2C00.N5"], [10.32, "B.20S2B00.N5"], [4.4, "B.20S2A00.N5"]]],
[360, [[23.65, ""], [20.77, "B.20S2C00.N5"], [10.32, "B.20S2B00.N5"], [4.4, "B.20S2A00.N5"]]],
[365, [[24.2, ""], [20.22, "B.20S2C00.N5"], [10.32, "B.20S2B00.N5"], [4.4, "B.20S2A00.N5"]]],
[375, [[24.75, ""], [20.22, "B.20S2C00.N5"], [10.32, "B.20S2B00.N5"], [4.4, "B.20S2A00.N5"]]],
[385, [[25.3, ""], [20.22, "B.20S2C00.N5"], [10.32, "B.20S2B00.N5"], [4.4, "B.20S2A00.N5"]]],
[390, [[25.3, ""], [19.67, "B.20S2C00.N5"], [10.32, "B.20S2B00.N5"], [4.4, "B.20S2A00.N5"]]],
[395, [[25.85, ""], [19.67, "B.20S2C00.N5"], [10.32, "B.20S2B00.N5"], [4.4, "B.20S2A00.N5"]]],
[400, [[26.4, ""], [19.67, "B.20S2C00.N5"], [9.77, "B.20S2B00.N5"], [4.95, "B.20S2A00.N5"]]],
[410, [[26.95, ""], [19.67, "B.20S2C00.N5"], [9.77, "B.20S2B00.N5"], [4.95, "B.20S2A00.N5"]]],
[415, [[27.5, ""], [19.12, "B.20S2C00.N5"], [9.77, "B.20S2B00.N5"], [4.95, "B.20S2A00.N5"]]],
[425, [[28.05, ""], [19.12, "B.20S2C00.N5"], [9.77, "B.20S2B00.N5"], [4.95, "B.20S2A00.N5"]]],
[435, [[28.6, ""], [19.12, "B.20S2C00.N5"], [9.77, "B.20S2B00.N5"], [4.95, "B.20S2A00.N5"]]],
[440, [[28.6, ""], [18.57, "B.20S2C00.N5"], [9.77, "B.20S2B00.N5"], [4.95, "B.20S2A00.N5"]]],
[445, [[29.15, ""], [18.57, "B.20S2C00.N5"], [9.77, "B.20S2B00.N5"], [4.95, "B.20S2A00.N5"]]],
[450, [[29.7, ""], [18.57, "B.20S2C00.N5"], [9.22, "B.20S2B00.N5"], [4.95, "B.20S2A00.N5"]]],
[460, [[30.25, ""], [18.02, "B.20S2C00.N5"], [9.22, "B.20S2B00.N5"], [4.95, "B.20S2A00.N5"]]],
[465, [[30.25, ""], [18.02, "B.20S2C00.N5"], [9.22, "B.20S2B00.N5"], [5.5, "B.20S2A00.N5"]]],
[470, [[30.8, ""], [18.02, "B.20S2C00.N5"], [9.22, "B.20S2B00.N5"], [5.5, "B.20S2A00.N5"]]],
[475, [[30.8, ""], [17.47, "B.20S2C00.N5"], [9.09, "B.20S2B00.N5"], [5.5, "B.20S2A00.N5"]]],
[480, [[31.35, ""], [17.47, "B.20S2C00.N5"], [9.09, "B.20S2B00.N5"], [5.5, "B.20S2A00.N5"]]],
[490, [[31.9, ""], [17.47, "B.20S2C00.N5"], [9.09, "B.20S2B00.N5"], [5.5, "B.20S2A00.N5"]]],
[495, [[31.9, ""], [16.92, "B.20S2C00.N5"], [9.09, "B.20S2B00.N5"], [5.5, "B.20S2A00.N5"]]],
[500, [[32.45, ""], [16.92, "B.20S2C00.N5"], [8.54, "B.20S2B00.N5"], [5.5, "B.20S2A00.N5"]]],
[515, [[32.45, ""], [16.37, "B.20S2C00.N5"], [8.54, "B.20S2B00.N5"], [5.5, "B.20S2A00.N5"]]],
[520, [[33, ""], [16.37, "B.20S2C00.N5"], [8.54, "B.20S2B00.N5"], [5.5, "B.20S2A00.N5"]]],
[526, [[36.85, ""], [27.5, "B.20S2F00.N5"], [14.59, "B.20S2E00.N5"], [6.6, "B.20S2D00.N5"]]],
[540, [[37.4, ""], [27.5, "B.20S2F00.N5"], [14.04, "B.20S2E00.N5"], [6.6, "B.20S2D00.N5"]]],
[545, [[37.95, ""], [26.95, "B.20S2F00.N5"], [14.04, "B.20S2E00.N5"], [6.6, "B.20S2D00.N5"]]],
[555, [[38.5, ""], [26.95, "B.20S2F00.N5"], [14.04, "B.20S2E00.N5"], [6.6, "B.20S2D00.N5"]]],
[560, [[38.5, ""], [26.4, "B.20S2F00.N5"], [14.04, "B.20S2E00.N5"], [6.6, "B.20S2D00.N5"]]],
[565, [[39.05, ""], [26.4, "B.20S2F00.N5"], [13.49, "B.20S2E00.N5"], [6.6, "B.20S2D00.N5"]]],
[575, [[39.6, ""], [25.85, "B.20S2F00.N5"], [13.49, "B.20S2E00.N5"], [6.6, "B.20S2D00.N5"]]],
[585, [[40.15, ""], [25.72, "B.20S2F00.N5"], [13.49, "B.20S2E00.N5"], [6.6, "B.20S2D00.N5"]]],
[590, [[40.15, ""], [25.72, "B.20S2F00.N5"], [12.94, "B.20S2E00.N5"], [6.6, "B.20S2D00.N5"]]],
[595, [[40.7, ""], [25.17, "B.20S2F00.N5"], [12.94, "B.20S2E00.N5"], [6.6, "B.20S2D00.N5"]]],
[615, [[41.25, ""], [24.62, "B.20S2F00.N5"], [12.52, "B.20S2E00.N5"], [6.6, "B.20S2D00.N5"]]],
[635, [[41.25, ""], [24.62, "B.20S2F00.N5"], [11.97, "B.20S2E00.N5"], [6.6, "B.20S2D00.N5"]]],
[640, [[41.25, ""], [24.07, "B.20S2F00.N5"], [11.97, "B.20S2E00.N5"], [6.6, "B.20S2D00.N5"]]],
[650, [[41.8, ""], [24.07, "B.20S2F00.N5"], [11.97, "B.20S2E00.N5"], [6.6, "B.20S2D00.N5"]]],
[665, [[41.8, ""], [23.52, "B.20S2F00.N5"], [11.42, "B.20S2E00.N5"], [6.6, "B.20S2D00.N5"]]],
[676, [[47.3, ""], [29.44, "B.20S2I00.N5"], [17.05, "B.20S2H00.N5"], [7.7, "B.20S2G00.N5"]]],
[685, [[47.3, ""], [28.89, "B.20S2I00.N5"], [17.05, "B.20S2H00.N5"], [7.7, "B.20S2G00.N5"]]],
[690, [[47.3, ""], [28.89, "B.20S2I00.N5"], [16.5, "B.20S2H00.N5"], [7.7, "B.20S2G00.N5"]]],
[695, [[47.3, ""], [28.73, "B.20S2I00.N5"], [16.5, "B.20S2H00.N5"], [7.7, "B.20S2G00.N5"]]],
[705, [[47.3, ""], [28.6, "B.20S2I00.N5"], [16.5, "B.20S2H00.N5"], [7.7, "B.20S2G00.N5"]]],
[710, [[46.75, ""], [28.6, "B.20S2I00.N5"], [16.5, "B.20S2H00.N5"], [7.7, "B.20S2G00.N5"]]],
[715, [[46.75, ""], [28.05, "B.20S2I00.N5"], [16.08, "B.20S2H00.N5"], [7.7, "B.20S2G00.N5"]]],
[725, [[46.2, ""], [28.05, "B.20S2I00.N5"], [16.08, "B.20S2H00.N5"], [7.7, "B.20S2G00.N5"]]],
[730, [[46.2, ""], [27.92, "B.20S2I00.N5"], [16.08, "B.20S2H00.N5"], [7.7, "B.20S2G00.N5"]]],
[735, [[45.65, ""], [27.92, "B.20S2I00.N5"], [15.95, "B.20S2H00.N5"], [7.7, "B.20S2G00.N5"]]],
[740, [[45.65, ""], [27.5, "B.20S2I00.N5"], [15.53, "B.20S2H00.N5"], [7.7, "B.20S2G00.N5"]]],
[745, [[45.1, ""], [27.37, "B.20S2I00.N5"], [15.53, "B.20S2H00.N5"], [7.7, "B.20S2G00.N5"]]],
[750, [[45.1, ""], [27.37, "B.20S2I00.N5"], [15.53, "B.20S2H00.N5"], [8.25, "B.20S2G00.N5"]]],
[755, [[45.1, ""], [27.24, "B.20S2I00.N5"], [15.53, "B.20S2H00.N5"], [8.25, "B.20S2G00.N5"]]],
[760, [[44.55, ""], [27.08, "B.20S2I00.N5"], [15.53, "B.20S2H00.N5"], [8.25, "B.20S2G00.N5"]]],
[765, [[44.55, ""], [26.69, "B.20S2I00.N5"], [15.53, "B.20S2H00.N5"], [8.25, "B.20S2G00.N5"]]],
[770, [[44.55, ""], [26.69, "B.20S2I00.N5"], [14.98, "B.20S2H00.N5"], [8.25, "B.20S2G00.N5"]]],
[775, [[44.55, ""], [26.69, "B.20S2I00.N5"], [14.98, "B.20S2H00.N5"], [8.8, "B.20S2G00.N5"]]],
[780, [[44.55, ""], [26.53, "B.20S2I00.N5"], [14.98, "B.20S2H00.N5"], [8.8, "B.20S2G00.N5"]]],
[785, [[44, ""], [26.53, "B.20S2I00.N5"], [14.98, "B.20S2H00.N5"], [8.8, "B.20S2G00.N5"]]],
[790, [[44, ""], [25.98, "B.20S2I00.N5"], [14.85, "B.20S2H00.N5"], [8.8, "B.20S2G00.N5"]]]
]

var hl_table = [
[300, "B.20L3200.05", [[2.75, "B.20L2100.N5"], [8.5, "B.20L2300.N5"], [13.5, "B.20L2500.N5"], [25.3125, "B.20L2700.N5"], [25.3125, "B.20L2700.N5"], [44, ""]]],
[350, "B.20L3500.05", [[2.75, "B.20L2100.N5"], [4.6875, "B.20L2300.N5"], [10.1875, "B.20L2500.N5"], [18.6875, "B.20L2700.N5"], [28.3125, "B.20L2900.N5"], [44, ""]]],
[400, "B.20L3800.06", [[3.8125, "B.20L2300.N5"], [3.8125, "B.20L2300.N5"], [6.875, "B.20L2500.N5"], [13.75, "B.20L2700.N5"], [24.5, "B.20L2900.N5"], [44, ""]]]
]

var materials_list = {
"flat_panel_construction": {
	"Oak": "1.54",
	"Cherry": "1.39",
	"Maple": "1.70",
	"Ash": "1.70",
	"Pine": "1.19",
	"Hickory": "1.97",
	"Alder": "1.19",
	"Lyptus": "1.54",
	"Walnut": "1.35",
	"Birch": "1.58",
	"Mahogany": "1.35",
	"Beech": "1.54",
	"Paint grade": "1.54"},
"raised_panel_construction": {
	"Oak": "2.27",
	"Cherry": "2.04",
	"Maple": "2.49",
	"Ash": "2.49",
	"Pine": "1.76",
	"Hickory": "2.89",
	"Alder": "1.76",
	"Lyptus": "2.27",
	"Walnut": "1.98",
	"Birch": "2.32",
	"Mahogany": "1.98",
	"Beech": "2.27",
	"Paint grade": "2.27",
	"MDF": "2.80"},
"slab_door_construction": {
	"Oak": "2.54",
	"Cherry": "2.29",
	"Maple": "2.79",
	"Ash": "2.79",
	"Pine": "1.97",
	"Hickory": "3.24",
	"Alder": "1.97",
	"Lyptus": "2.54",
	"Walnut": "2.22",
	"Birch": "2.60",
	"Mahogany": "2.22",
	"Beech": "2.54",
	"Paint grade": "2.54",
	"MDF": "2.89",
	"Particle board": "2.98",
	"Bamboo": "1.38",
	"Plywood": "2.00"},
"alum_frame_a_construction": {
	"Glass": "2.60"},
"alum_frame_b_construction": {
	"Glass": "2.85"},
"alum_frame_d_construction": {
	"Glass": "2.35"},
"wood_frame_construction": {
	"Glass": "1.70"}
}

var min_cabinet_height = {
"HF": [483, "19"],
"HS": [349, "13 3/4"],
"HK": [241, "9 1/2"],
"HK-S": [187, "7 3/8"],
"HL": [300, "11 13/16"],
"HL appliance garage": [450, "17 3/4"]
}

var max_cabinet_height = {
"HF": [1067, "42"],
"HS": [800, "31 1/2"],
"HK": [610, "24"],
"HK-S": [400, "15 3/4"],
"HL": [550, "21 5/8"],
"HL appliance garage": [580, "22 13/16"]
}

var sku_info = {},
	is_updating = false,
	skus_to_load = [],
	pending_skus = [],
	cookie_session = "",
	vars = {},
	prev_value = "",
	cabinet_height = 0,
	door_weight = 0,
	handle_weight = 0

function read_cookie(name) {
	var nameEQ = name + "=";
	var ca = document.cookie.split(';');
	for(var i=0;i < ca.length;i++) {
		var c = ca[i];
		while (c.charAt(0)==' ') c = c.substring(1,c.length);
		if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
	}
	return null;
}

function split_parameters(param_list) {
	//if (!param_list) {
	//	return null
	//}
	param_list = decodeURIComponent(param_list).split("&")
	var params = {}
	var param = ""
	for (var i=0; i<param_list.length; i++) {
		param = param_list[i].split("=")
		params[param[0]] = encodeURIComponent(param[1])
	}
	return params
}

function intext(obj) {
	prev_value = obj.value
	if (obj.value == "0" || obj.value == "0.0") {
		obj.value = ""
	}
	obj.select()
}

function outtext(obj) {
	// make sure floats always stay floats
	if (prev_value.indexOf(".") > -1) {
		obj.value = (isNaN(parseFloat(obj.value))) ? "0.0" : Math.abs(parseFloat(obj.value))
		obj.value = (obj.value.indexOf(".") > -1) ? obj.value : obj.value + ".0"
	} else {
		obj.value = (isNaN(parseInt(obj.value))) ? "0" : Math.abs(parseInt(obj.value))
	}
	if (obj.value != prev_value) {
		update_page(obj)
	}
}

function NumbersOnly(myfield, e) {
	var key;
	var keychar;
	if (window.event) {
		key = window.event.keyCode;
	} else if (e) {
		key = e.which;
	} else {
		return true;
	}
	keychar = String.fromCharCode(key);
	// control keys
	if ((key==null) || (key==0) || (key==8) || (key==9) || (key==27) ) {
		return true;
	} else if ((key==13) || (key==32)) { // no enters or spaces
		return false;
	} else if (keychar=='.' && myfield.value.indexOf('.')>-1) { // only one deicmal
		return false;
	} else if ((("0123456789").indexOf(keychar) > -1)) { // numbers
		return true;
	} else {
		return false;
	}
} 

function save_sku_qty(elem) {
	var sku = elem.parentNode.parentNode.firstChild.nextSibling.innerHTML
	sku_info[sku].qty = elem.value
}

// Makes the AJAX call for queued skus and writes received data to the appropriate <tr>
function flush_pending_skus() {
	var str = '', sku
	while (skus_to_load.length > 0) { // build the AJAX search string
		sku = skus_to_load.pop()
		//str += (str ? ("|or|searchexact~p.sku~" + sku) : ("searchexact~p.sku~" + sku))
		str += (str ? ("|" + sku) : (sku))
	}
	while (pending_skus.length > 0) { // seldom, if ever, will both of these while loops run in the same function call
		sku = pending_skus.pop()
		// gets the inner data of the <tr> returned by get_tr_from_sku() and writes it to the <tr> with id=sku
		// jQuery doesn't like periods or colons in the id (thinks it's a CSS selector), so we escape it with .replace()
		jQuery("#" + sku.replace(/(:|\.)/g,'\\$1')).html(jQuery('<div />').html(get_tr_from_sku(sku)).children(":first").html())
	}
	if (str) { // if a search string was built, make the AJAX call below
		jQuery.get("/ssajax", {rb_id: "0AFBE47B797546FFB51B455F9E12553A", sku: str}, function(data) {
			jQuery("record", data).each(function () {
				var record = jQuery(this)
				sku = record.find("sku").text()
				sku_info[sku] = {}
				sku_info[sku].p_key = record.find("p_key").text()
				sku_info[sku].nm = record.find("nm").text()
				sku_info[sku].ds = jQuery('<div />').html(record.find("ds").text()).text()
				sku_info[sku].retail_price = parseFloat(record.find("retail_price").text())
				sku_info[sku].image = record.find("thumb").text()
				sku_info[sku].qty = ''
				pending_skus.push(sku)
			})
			// the is_updating flag is set and cleared by update_parts(); we don't want to write the pending skus until update_parts() finishes
			//  update_parts() calls flush_pending_skus() when it is done
			if (!is_updating) {
				flush_pending_skus()
			}
		})
	}
}

function get_tr_from_sku(sku) {
	if (!sku_info[sku]) { // if the sku hasn't been stored, we need to get it
		// queue the sku for the AJAX call
		skus_to_load.push(sku)
		// return an empty <tr> that will be populated once the AJAX call is made
		return '<tr id="' + sku + '"><td class="sku_image">&nbsp;</td><td class="sku_td">' + sku + '</td><td>Loading product info...</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>'
	} else {
		var str = '<tr id="' + sku + '"><td class="sku_image"><img src="' + sku_info[sku].image + '" /></td>'
		str += '<td>' + sku + '</td>'
		str += '<td><div class="sku_name">' + sku_info[sku].nm + '</div><div class="sku_desc">' + sku_info[sku].ds + '</div></td>'
		str += '<td class="sku_price">$' + sku_info[sku].retail_price.toFixed(2) + '</td>'
		str += '<td>Qty: <input type="hidden" name="keys" value="' + sku_info[sku].p_key + '" /><input type="text" name="qty[' + sku_info[sku].p_key + ']" onfocus="this.select();" onkeypress="return NumbersOnly(this, event);" onchange="save_sku_qty(this)" value="' + sku_info[sku].qty + '" class="qtyinput" tabindex="" /></td></tr>'
		return str
	}
}

function get_table_index(val, table) {
	var i = 0, j = 0
	while (i < table.length - 1) {		i++		if (val >= table[i][0]) {			j = i		}
	}
	return j
}

function toggle_desc(elem) {
	if (elem.parentNode.previousSibling.style.display == "none") {
		elem.innerHTML = "[-] Show less"
	} else {
		elem.innerHTML = "[+] Show more"
	}
	jQuery(elem.parentNode.previousSibling).slideToggle()
}

function select_construction(elem) {
	var select_material = document.getElementById("select_material")
	select_material.options.length = 0 // clear the select box
	for (var key in materials_list[elem.options[elem.selectedIndex].value]) {
		select_material.options[select_material.options.length] = new Option(key, materials_list[elem.options[elem.selectedIndex].value][key], false, false)
	}
	select_material.size = (select_material.options.length == 1) ? 2 : select_material.options.length
	vars["select_material"] = ""
	update_parts()
}

function update_page(elem) {
	vars[elem.name] = elem.value
	switch(elem.name) {
	case "door_type":
		if (vars["lift_type"]) {
			jQuery("#step2").slideDown()
		}
		break;
	case "lift_type":
		if (vars["door_type"]) {
			jQuery("#step2").slideDown()
		}
		document.getElementById("cabinet_height_min_max").innerHTML = "(" + min_cabinet_height[elem.value][1] + " - " + max_cabinet_height[elem.value][1] + " in for the " + elem.value + " lift system)"
		break;
	case "handle_weight_lbs":
	case "handle_weight_oz":
		handle_weight = (vars["handle_weight_oz"]) ? (parseFloat(vars["handle_weight_oz"]) / 16) : 0
		handle_weight += (vars["handle_weight_lbs"]) ? parseInt(vars["handle_weight_lbs"]) : 0
		break;
	case "door_weight_lbs":
	case "door_weight_oz":
		door_weight = (vars["door_weight_oz"]) ? (parseFloat(vars["door_weight_oz"]) / 16) : 0
		door_weight += (vars["door_weight_lbs"]) ? parseInt(vars["door_weight_lbs"]) : 0
		document.getElementById("door_input_manual").checked = true
		break;
	case "cabinet_height":
		cabinet_height = parseInt(parseFloat(elem.value) * 25.4) // convert to millimeters
		break;
	case "door_input":
		if (elem.value == "manual") {
			document.getElementById("door_weight_lbs").disabled = false
			document.getElementById("door_weight_oz").disabled = false
			jQuery("#door_weight_calculator").slideUp()
			break;
		} else {
			document.getElementById("door_weight_lbs").disabled = true
			document.getElementById("door_weight_oz").disabled = true
			jQuery("#door_weight_calculator").slideDown()
		}
	case "select_material":
	case "door_height":
	case "door_width":
		if (vars["select_material"]) {
			door_weight = (vars["door_width"]) ? parseFloat(vars["door_width"]) : 0
			door_weight = ((door_weight * ((vars["door_height"]) ? parseFloat(vars["door_height"]) : 0)) / 144) * parseFloat(vars["select_material"])
			if (door_weight) {
				document.getElementById("door_weight_lbs").value = parseInt(door_weight)
				vars["door_weight_lbs"] = document.getElementById("door_weight_lbs").value
				document.getElementById("door_weight_oz").value = parseInt((door_weight -  parseInt(door_weight)) * 16)
				vars["door_weight_oz"] = document.getElementById("door_weight_oz").value
			}
		}
	}
	update_parts()
}

function update_parts() {
	is_updating = true
	var html_string = ""
	// look for errors
	  // missing values
	if (!vars["door_type"]) {
		html_string = "Please select a door type first."
	} else if (!vars["lift_type"]) {
		html_string = "Please select a lift type."
	} else if (!vars["cabinet_height"]) {
		html_string = "Please enter the height of the cabinet."
	} // verify cabinet height is in range
	else if (cabinet_height < min_cabinet_height[vars["lift_type"]][0]) {
		html_string = "Sorry! The cabinet height given is less than the minimum cabinet height needed for the " + vars["lift_type"] + " lift system."
	} else if (cabinet_height > max_cabinet_height[vars["lift_type"]][0]) {
		html_string = "Sorry! The cabinet height given is greater than the maximum cabinet height supported by the " + vars["lift_type"] + " lift system."
	} else if (vars["door_input"] != "calculator" && !vars["door_weight_lbs"] && !vars["door_weight_oz"]) {
		html_string = "Please enter the weight of the door and handle, either manually or using the estimator."
	} else {
		// verify door weight is in range
		switch(vars["lift_type"]) {
		case "HF":
			pf = Math.round((cabinet_height / 25.4) * (door_weight + handle_weight))
			if (pf < 85 ) {
				html_string = "Sorry! The combined door and handle weight of " + Math.round((door_weight + handle_weight) * 100) / 100 + " lbs does not weigh enough for the " + vars["lift_type"] + " lift system on a " + vars["cabinet_height"] + " inch cabinet."
			} else if (pf > 2300) {
				html_string = "Sorry! The combined door and handle weight of " + Math.round((door_weight + handle_weight) * 100) / 100 + " lbs is too heavy for the " + vars["lift_type"] + " lift system on a " + vars["cabinet_height"] + " inch cabinet."
			}
			break;
		case "HS":
			i = get_table_index(cabinet_height, hs_table)
			if (hs_table[i][1][0][0] < (door_weight + handle_weight)) {
				html_string = "Sorry! The combined door and handle weight of " + Math.round((door_weight + handle_weight) * 100) / 100 + " lbs is too heavy for the " + vars["lift_type"] + " lift system on a " + vars["cabinet_height"] + " inch cabinet."
			} else if (hs_table[i][1][3][0] > (door_weight + handle_weight)) {
				html_string = "Sorry! The combined door and handle weight of " + Math.round((door_weight + handle_weight) * 100) / 100 + " lbs does not weigh enough for the " + vars["lift_type"] + " lift system on a " + vars["cabinet_height"] + " inch cabinet."
			}
			break;
		case "HK":
			pf = Math.round((cabinet_height / 25.4) * (door_weight + handle_weight))
			if (pf < 43 ) {
				html_string = "Sorry! The combined door and handle weight of " + Math.round((door_weight + handle_weight) * 100) / 100 + " lbs does not weigh enough for the " + vars["lift_type"] + " lift system on a " + vars["cabinet_height"] + " inch cabinet."
			} else if (pf > 792) {
				html_string = "Sorry! The combined door and handle weight of " + Math.round((door_weight + handle_weight) * 100) / 100 + " lbs is too heavy for the " + vars["lift_type"] + " lift system on a " + vars["cabinet_height"] + " inch cabinet."
			}
			break;
		case "HK-S":
			pf = Math.round((cabinet_height / 25.4) * (door_weight + handle_weight))
			if (pf < 19 ) {
				html_string = "Sorry! The combined door and handle weight of " + Math.round((door_weight + handle_weight) * 100) / 100 + " lbs does not weigh enough for the " + vars["lift_type"] + " lift system on a " + vars["cabinet_height"] + " inch cabinet."
			} else if (pf > 177) {
				html_string = "Sorry! The combined door and handle weight of " + Math.round((door_weight + handle_weight) * 100) / 100 + " lbs is too heavy for the " + vars["lift_type"] + " lift system on a " + vars["cabinet_height"] + " inch cabinet."
			}
			break;
		case "HL":
			i = get_table_index(cabinet_height, hl_table)
			if (hl_table[i][2][4][0] < (door_weight + handle_weight)) {
				html_string = "Sorry! The combined door and handle weight of " + Math.round((door_weight + handle_weight) * 100) / 100 + " lbs is too heavy for the " + vars["lift_type"] + " lift system on a " + vars["cabinet_height"] + " inch cabinet."
			} else if (hl_table[i][2][0][0] > (door_weight + handle_weight)) {
				html_string = "Sorry! The combined door and handle weight of " + Math.round((door_weight + handle_weight) * 100) / 100 + " lbs does not weigh enough for the " + vars["lift_type"] + " lift system on a " + vars["cabinet_height"] + " inch cabinet."
			}
			break;
		case "HL appliance garage":
			if ((door_weight + handle_weight) > 36.32) {
				html_string = "Sorry! The combined door and handle weight of " + Math.round((door_weight + handle_weight) * 100) / 100 + " lbs is too heavy for the " + vars["lift_type"] + " lift system on a " + vars["cabinet_height"] + " inch cabinet."
			} else if ((door_weight + handle_weight) < 2.18) {
				html_string = "Sorry! The combined door and handle weight of " + Math.round((door_weight + handle_weight) * 100) / 100 + " lbs does not weigh enough for the " + vars["lift_type"] + " lift system on a " + vars["cabinet_height"] + " inch cabinet."
			}
		}
		// check to make sure door calculator steps are complete
		if (vars["door_input"] == "calculator") {
			if (!vars["select_material"]) {
				html_string = "To estimate the weight of the door, you must specify the door's construction and material."
			} else if (!vars["door_height"] || !vars["door_width"] || !door_weight) {
				html_string = "To estimate the weight of the door, you must specify both the width and height of the door."
			}
		}
		// check for cookie
		if (!cookie_session) {
			html_string = "Error: Cookies must be enabled."
		}
		
		// load and list the part numbers
		if (html_string == "") { // if html_string is empty, then there was no error
			// warn if door handle weight is not given
			if (!handle_weight) {
				html_string += "<p>Note: A handle weight was not specified (if this was intentional, you may disregard this note).</p>"
			}
			html_string += '<form action="http://' + window.location.hostname + '/addcart?'
			html_string += 'type=v200add&o_url=https%3A%2F%2F' + window.location.hostname.replace(".","%2E") + '&createsessioncookie=1&noredirect=1&'
			html_string += "a_name=" + cookie_session["a_name"] + "&"
			html_string += "c_Lastname=" + cookie_session["c_Lastname"] + "&"
			html_string += "c_firstName=" + cookie_session["c_firstName"] + "&"
			html_string += "c_userName=" + cookie_session["c_userName"] + "&"
			html_string += "c_id=" + cookie_session["c_id"] + "&"
			html_string += "a_id=" + cookie_session["a_id"] + "&"
			html_string += "s_url=" + cookie_session["s_url"] + "&"
			html_string += "s_key=" + cookie_session["s_key"] + "&"
			html_string += "l_ws_key=" + cookie_session["l_ws_id"] + "&"
			html_string += "sc_id=" + cookie_session["s_key"]
			html_string += '" method="post">'
			html_string += '<div class="required_header">Required Components</div><div class="required_components"><img src="images/' + ((vars["lift_type"] == "HL appliance garage") ? "HL" : vars["lift_type"]) + '_blowout.png" /></div>'
			html_string += '<table class="parts_list">'
			switch(vars["lift_type"]) {
			case "HF":
				html_string += '<tr><th colspan="4">Lift mechanism <img src="images/id_num_1.png" /></th></tr>'
				pf = Math.round((cabinet_height / 25.4) * (door_weight + handle_weight))
				if (pf <= 230) {
					html_string += get_tr_from_sku("B.20F2200.N5")
					html_string += '<tr><td>&nbsp;</td><td colspan="3" class="sku_note">Note: Only one lift mechanism out of the pair is required for this door weight (sold as a pair, not sold individually).</td></tr>'
				} else if (pf <= 470) {
					html_string += get_tr_from_sku("B.20F2200.N5")
				} else if (pf <= 780) {
					html_string += get_tr_from_sku("B.20F2500.N5")
				} else if (pf <= 880) {
					html_string += get_tr_from_sku("B.20F2500.N5")
					html_string += '<tr><td>&nbsp;</td><td colspan="3" class="sku_note">OR</td></tr>'
					html_string += get_tr_from_sku("B.20F2800.N5")
					html_string += '<tr><td>&nbsp;</td><td colspan="3" class="sku_note">Note: Trial application recommended when the door weight is in a borderline area of lift mechanisms.</td></tr>'
				} else if (pf <= 1401) {
					html_string += get_tr_from_sku("B.20F2800.N5")
				} else {
					html_string += get_tr_from_sku("B.20F2800.N5")
					html_string += '<tr><td>&nbsp;</td><td colspan="3" class="sku_note">Note: Three lift mechanisms are required for this door weight (sold as a pair, not sold individually).</td></tr>'
				}
				html_string += '<tr><th colspan="4">Arm assembly <img src="images/id_num_2.png" /></th></tr>'
				if (cabinet_height < 558) {
					html_string += get_tr_from_sku("B.20F3200")
				} else if (cabinet_height < 686) {
					html_string += get_tr_from_sku("B.20F3500")
				} else if (cabinet_height < 889) {
					html_string += get_tr_from_sku("B.20F3800")
				} else {
					html_string += get_tr_from_sku("B.20F3900.01")
				}
				html_string += '<tr><td>&nbsp;</td><td colspan="3" class="sku_note">Note: One telescopic arm is required per lift mechanism (sold as a pair, not sold individually).</td></tr>'
				html_string += '<tr><th colspan="4">Cover set <img src="images/id_num_3.png" /></th></tr>'
				html_string += get_tr_from_sku("B.20F8000.NA")
				html_string += '<tr><th colspan="4">Hardware <img src="images/id_num_4.png" /></th></tr>'
				if (vars["door_type"] == "wide") {
					html_string += get_tr_from_sku("B.78Z5530TA5")
					html_string += get_tr_from_sku("B.606N-100")
					html_string += '<tr><td>&nbsp;</td><td colspan="3" class="sku_note">OR</td></tr>'
					html_string += get_tr_from_sku("B.7072A-100")
					html_string += '<tr><th colspan="4">Mounting plate (for use with large overlay five-piece doors)</th></tr>'
					html_string += get_tr_from_sku("B.175H5F00.01")
				} else {
					html_string += get_tr_from_sku("B.78Z550ATA5")
					html_string += get_tr_from_sku("B.606N-100")
				}
				html_string += '<tr><th colspan="4">Accessories</th></tr>'
				html_string += get_tr_from_sku("B.20F7051")
				html_string += get_tr_from_sku("B.20F7011")


				break;
			case "HS":
				sku = ""
				for (j = 1; j < 4 && !sku; j++) {
					if ((door_weight + handle_weight) >= hs_table[i][1][j][0]) {
						sku = hs_table[i][1][j][1]
					}
				}
				html_string += '<tr><th colspan="4">Lift mechanism <img src="images/id_num_1.png" /></th></tr>'
				html_string += get_tr_from_sku(sku)
				html_string += '<tr><th colspan="4">Arm assembly <img src="images/id_num_2.png" /></th></tr>'
				html_string += get_tr_from_sku("B.20S3500.06")
				html_string += '<tr><th colspan="4">Cover set <img src="images/id_num_3.png" /></th></tr>'
				html_string += get_tr_from_sku("B.20S8000.NA")
				html_string += '<tr><th colspan="4">Round stabilizer rod <img src="images/id_num_4.png" /></th></tr>'
				html_string += get_tr_from_sku("B.20Q1061UN")
				html_string += get_tr_from_sku("B.20Q091Z")
				html_string += '<tr><td>&nbsp;</td><td colspan="3" class="sku_note">Note: Rod connector set required for cabinets wider than 48" (as well as an additional stabilizer rod).</td></tr>'
				html_string += '<tr><th colspan="4">Hardware <img src="images/id_num_5.png" /></th></tr>'
				if (vars["door_type"] == "wide") {
					html_string += get_tr_from_sku("B.20S4200")
					html_string += get_tr_from_sku("B.606N-100")
					html_string += '<tr><td>&nbsp;</td><td colspan="3" class="sku_note">OR</td></tr>'
					html_string += get_tr_from_sku("B.7072A-100")
					html_string += '<tr><th colspan="4">Mounting plate (for use with large overlay five-piece doors)</th></tr>'
					html_string += get_tr_from_sku("B.20S4F01")
				} else {
					html_string += get_tr_from_sku("B.20S4200A")
				}
				html_string += '<tr><th colspan="4">Accessories</th></tr>'


				break;
			case "HK":
				html_string += '<tr><th colspan="4">Lift mechanism <img src="images/id_num_1.png" /></th></tr>'
				pf = Math.round((cabinet_height / 25.4) * (door_weight + handle_weight))
				if (pf <= 99) {
					html_string += get_tr_from_sku("B.20K2300.N5")
				} else if (pf <= 174) {
					html_string += get_tr_from_sku("B.20K2500.N5")
				} else if (pf <= 349) {
					html_string += get_tr_from_sku("B.20K2700.N5")
				} else {
					html_string += get_tr_from_sku("B.20K2900.N5")
				}
				html_string += '<tr><th colspan="4">Cover set <img src="images/id_num_2.png" /></th></tr>'
				html_string += get_tr_from_sku("B.20K8000.NA")
				html_string += '<tr><th colspan="4">Hardware <img src="images/id_num_3.png" /></th></tr>'
				if (vars["door_type"] == "wide") {
					html_string += get_tr_from_sku("B.20S4200")
					html_string += get_tr_from_sku("B.606N-100")
					html_string += '<tr><td>&nbsp;</td><td colspan="3" class="sku_note">OR</td></tr>'
					html_string += get_tr_from_sku("B.7072A-100")
					html_string += '<tr><th colspan="4">Mounting plate (for use with large overlay five-piece doors)</th></tr>'
					html_string += get_tr_from_sku("B.20S4F01")
				} else {
					html_string += get_tr_from_sku("B.20S4200A")
				}
				html_string += '<tr><th colspan="4">Accessories</th></tr>'
				html_string += get_tr_from_sku("B.20K7041")
				html_string += get_tr_from_sku("B.20K7011")
				break;
			case "HK-S":
				html_string += '<tr><th colspan="4">Lift mechanism/cover set <img src="images/id_num_1.png" /></th></tr>'
				pf = Math.round((cabinet_height / 25.4) * (door_weight + handle_weight))
				if (pf <= 39) {
					html_string += get_tr_from_sku("B.20K2B00.NA")
				} else if (pf <= 85) {
					html_string += get_tr_from_sku("B.20K2C00.NA")
				} else {
					html_string += get_tr_from_sku("B.20K2E00.NA")
				}
				html_string += '<tr><th colspan="4">Hardware <img src="images/id_num_2.png" /></th></tr>'
				if (vars["door_type"] == "wide") {
					html_string += get_tr_from_sku("B.20K4A00")
					html_string += get_tr_from_sku("B.606N-100")
					html_string += '<tr><td>&nbsp;</td><td colspan="3" class="sku_note">OR</td></tr>'
					html_string += get_tr_from_sku("B.7072A-100")
				} else {
					html_string += get_tr_from_sku("B.20K4A00A")
				}
				html_string += '<tr><th colspan="4">Accessories</th></tr>'
				html_string += get_tr_from_sku("B.20K7A41")
				html_string += get_tr_from_sku("B.20K7A11")
				break;
			case "HL":
				sku = ""
				for (j = 0; j < 4 && !sku; j++) {
					if ((door_weight + handle_weight) >= hl_table[i][2][j][0]) {
						sku = hl_table[i][2][j][1]
					}
				}
				html_string += '<tr><th colspan="4">Lift mechanism <img src="images/id_num_1.png" /></th></tr>'
				html_string += get_tr_from_sku(sku)
				html_string += '<tr><th colspan="4">Arm assembly <img src="images/id_num_2.png" /></th></tr>'
				html_string += get_tr_from_sku(hl_table[i][1])
				html_string += '<tr><th colspan="4">Cover set <img src="images/id_num_3.png" /></th></tr>'
				html_string += get_tr_from_sku("B.20L8000.N1")
				html_string += '<tr><th colspan="4">Oval stabilizer rod <img src="images/id_num_4.png" /></th></tr>'
				html_string += get_tr_from_sku("B.20Q1061UA")
				html_string += get_tr_from_sku("B.20Q091ZA")
				html_string += '<tr><td>&nbsp;</td><td colspan="3" class="sku_note">Note: Rod connector set required for cabinets wider than 48" (as well as an additional stabilizer rod).</td></tr>'
				html_string += '<tr><th colspan="4">Hardware <img src="images/id_num_5.png" /></th></tr>'
				if (vars["door_type"] == "wide") {
					html_string += get_tr_from_sku("B.20S4200")
					html_string += get_tr_from_sku("B.606N-100")
					html_string += '<tr><td>&nbsp;</td><td colspan="3" class="sku_note">OR</td></tr>'
					html_string += get_tr_from_sku("B.7072A-100")
					html_string += '<tr><th colspan="4">Mounting plate (for use with large overlay five-piece doors)</th></tr>'
					html_string += get_tr_from_sku("B.20S4F01")
				} else {
					html_string += get_tr_from_sku("B.20S4200A")
				}
				html_string += '<tr><th colspan="4">Accessories</th></tr>'


				break;
			case "HL appliance garage":
				html_string += '<tr><th colspan="4">Lift mechanism <img src="images/id_num_1.png" /></th></tr>'
				comb_weight = door_weight + handle_weight
				if (comb_weight < 3.31) {
					html_string += get_tr_from_sku("B.20L2300.N5")
				} else if (comb_weight < 10.43) {
					html_string += get_tr_from_sku("B.20L2500.N5")
				} else if (comb_weight < 19.25) {
					html_string += get_tr_from_sku("B.20L2700.N5")
				} else {
					html_string += get_tr_from_sku("B.20L2900.N5")
				}
				html_string += '<tr><th colspan="4">Arm assembly <img src="images/id_num_2.png" /></th></tr>'
				html_string += get_tr_from_sku("B.20L3900.06")
				html_string += '<tr><th colspan="4">Cover set <img src="images/id_num_3.png" /></th></tr>'
				html_string += get_tr_from_sku("B.20L8000.N1")
				html_string += '<tr><th colspan="4">Oval stabilizer rod <img src="images/id_num_4.png" /></th></tr>'
				html_string += get_tr_from_sku("B.20Q1061UA")
				html_string += get_tr_from_sku("B.20Q091ZA")
				html_string += '<tr><td>&nbsp;</td><td colspan="3" class="sku_note">Note: Rod connector set required for cabinets wider than 48" (as well as an additional stabilizer rod).</td></tr>'
				html_string += '<tr><th colspan="4">Appliance garage corner bracket</th></tr>'
				html_string += get_tr_from_sku("B.20L7001")
				html_string += '<tr><th colspan="4">Hardware <img src="images/id_num_5.png" /></th></tr>'
				if (vars["door_type"] == "wide") {
					html_string += get_tr_from_sku("B.20S4200")
					html_string += get_tr_from_sku("B.606N-100")
					html_string += '<tr><td>&nbsp;</td><td colspan="3" class="sku_note">OR</td></tr>'
					html_string += get_tr_from_sku("B.7072A-100")
					html_string += '<tr><th colspan="4">Mounting plate (for use with large overlay five-piece doors)</th></tr>'
					html_string += get_tr_from_sku("B.20S4F01")
				} else {
					html_string += get_tr_from_sku("B.20S4200A")
				}
				html_string += '<tr><th colspan="4">Accessories</th></tr>'


			}
			html_string += get_tr_from_sku("B.65.5030.01")
			html_string += get_tr_from_sku("B.65.1051.01")
			html_string += get_tr_from_sku("B.ZML.0040")
			html_string += '<tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td><input type="submit" value="Add to Cart" class="btn_addtocart chrome" /></td></tr></table></form>'
		}
	}
	document.getElementById("parts").innerHTML = html_string
	is_updating = false
	flush_pending_skus()
}

jQuery(document).ready(function($)
{
	cookie_session = split_parameters(read_cookie("cookie%5Fsession"))
})