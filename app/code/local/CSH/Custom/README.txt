A bunch of class rewrites, event handlers, etc.

